(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{20:function(e,t,a){e.exports=a(35)},25:function(e,t,a){},35:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(17),c=a.n(o),l=a(2),i=a(9),s=a(6),u=(a(25),function(e){var t=e.routes,a=Object(n.useState)(!1),o=Object(l.a)(a,2),c=o[0],s=o[1],u=Object(n.useState)(window.navigator.onLine),d=Object(l.a)(u,2),m=d[0],f=d[1],p=function(){return f(!0)},w=function(){return f(!1)};return Object(n.useEffect)(function(){return window.addEventListener("online",p),window.addEventListener("offline",w),function(){window.removeEventListener("online",p),window.removeEventListener("offline",w)}},[]),r.a.createElement("nav",{className:"navbar navbar-expand-sm navbar-dark bg-dark fixed-top"},r.a.createElement("a",{className:"navbar-brand",href:"/#/"},"AWT-PWA"),r.a.createElement("button",{className:"navbar-toggler",type:"button","aria-expanded":c,"aria-label":"Toggle navigation",onClick:function(){return s(!c)}},r.a.createElement("span",{className:"navbar-toggler-icon"})),r.a.createElement("div",{className:"collapse navbar-collapse ".concat(c?"show":"")},r.a.createElement("div",{className:"navbar-nav"},t.map(function(e){var t=e.exact,a=e.key,n=e.label,o=e.path;return r.a.createElement(i.b,{key:a,exact:t,to:o,onClick:function(){return s(!1)},className:"nav-item nav-link",activeClassName:"active"},n,r.a.createElement("span",{className:"sr-only"},"(current)"))}))),m?r.a.createElement("button",{type:"button",className:"btn btn-success",disabled:!0},"Online"):r.a.createElement("button",{type:"button",className:"btn btn-danger",disabled:!0},"Offline"))}),d=function(e){var t=e.title,a=e.tagline,n=e.id,o=e.poster,c=e.onClickDownload,l=e.allowDownload;return r.a.createElement("div",{className:"col-md-6",style:{marginBottom:"1rem"}},r.a.createElement("div",{className:"card bg-dark text-white",style:{background:"black"}},r.a.createElement("img",{className:"card-img-top",src:o,alt:"image_".concat(t),style:{minHeight:"10rem",opacity:"0.4",borderRadius:".25rem"}}),r.a.createElement("div",{className:"card-img-overlay d-flex justify-content-between flex-column"},r.a.createElement("h5",{className:"card-title"},t),r.a.createElement("p",{className:"card-text"},a),r.a.createElement("div",{className:"text-right"},l&&r.a.createElement("div",{className:"btn-group",role:"group","aria-label":"Basic example"},r.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:c},"Download"),r.a.createElement("a",{className:"btn btn-primary",href:"/#/stream/".concat(n),role:"button"},"Watch now!"))))))},m=[{manifestUri:"//storage.googleapis.com/shaka-demo-assets/angel-one/dash.mpd",title:"Star Trek: Angel One",id:"ewion",tagline:"Enjoy some classic Star Trek!!!1",poster:"//shaka-player-demo.appspot.com/assets/poster.jpg"}],f=function(e){var t=e.history,a=function(e){!function(e){window.storage.getStoreInProgress()?alert("Download already in Progress!"):window.storage.store(e.manifestUri,{title:e.title,downloaded:Date(),id:e.id})}(e),t.push("/downloads")},o=Object(n.useState)(window.navigator.onLine),c=Object(l.a)(o,2),i=c[0],s=c[1],u=function(){return s(!0)},f=function(){return s(!1)};return Object(n.useEffect)(function(){return window.addEventListener("online",u),window.addEventListener("offline",f),function(){window.removeEventListener("online",u),window.removeEventListener("offline",f)}},[]),r.a.createElement(n.Fragment,null,r.a.createElement("form",{className:"form-inline",style:{paddingBottom:"1rem"}},r.a.createElement("input",{className:"form-control",type:"text",placeholder:"Search"}),r.a.createElement("div",{className:"form-check form-check-inline"},r.a.createElement("input",{className:"form-check-input",type:"checkbox",value:"",id:"defaultCheck1"}),r.a.createElement("label",{className:"form-check-label",htmlFor:"defaultCheck1"},"Show downloaded only"))),r.a.createElement("div",{className:"row"},m.map(function(e,t){return r.a.createElement(d,Object.assign({},e,{key:"media_".concat(t,"_").concat(e.title),onClickDownload:function(){return a(e)},allowDownload:!!i}))})))},p=a(8),w=a.n(p),v=a(10),g=function(){var e=Object(v.a)(w.a.mark(function e(){return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",navigator.storage.estimate().then(function(e){var t=e.quota,a=e.usage;return{quota:Math.round(t/1e6),usage:Math.round(a/1e6)}}));case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),b=function(){var e=Object(n.useState)({usage:0,quota:100}),t=Object(l.a)(e,2),a=t[0],o=t[1];return Object(n.useEffect)(function(){if("storage"in navigator&&"estimate"in navigator.storage){var e=setInterval(function(){g().then(o)},5e3);return g().then(o),function(){return clearInterval(e)}}},[]),r.a.createElement("div",{className:"card",style:{marginTop:"1rem"}},r.a.createElement("div",{className:"card-body"},"You have ",a.quota,"MB of accessible storage and currently use ",a.usage,"MB.",r.a.createElement("div",{className:"progress",style:{height:"2rem"}},r.a.createElement("div",{className:"progress-bar bg-info",role:"progressbar",style:{width:"".concat(a.usage/a.quota*100,"%")},"aria-valuenow":a.usage,"aria-valuemin":"0","aria-valuemax":a.quota}))))},E=function(e){var t=e.id,a=e.removeMedia,n=e.title,o=e.downloadedOn;return r.a.createElement("li",{className:"list-group-item"},n,r.a.createElement("br",null),r.a.createElement("small",null,o),r.a.createElement("hr",null),r.a.createElement("div",{className:"d-flex justify-content-between"},r.a.createElement("a",{className:"btn btn-primary",href:"/#/offline/".concat(t),role:"button"},"Watch"),r.a.createElement("button",{type:"button",className:"btn btn-danger",onClick:a},"Remove")))},h=function(){var e=Object(n.useState)(null),t=Object(l.a)(e,2),a=t[0],o=t[1];return Object(n.useEffect)(function(){return window.addEventListener("custom-progress",o),function(){window.removeEventListener("custom-progress",o)}},[]),r.a.createElement(n.Fragment,null,a&&r.a.createElement("li",{className:"list-group-item"},a.detail.content.appMetadata.title,r.a.createElement("br",null),r.a.createElement("small",null,a.detail.content.appMetadata.downloadedOn),r.a.createElement("hr",null),r.a.createElement("div",{className:"progress",style:{marginBottom:"0.5rem"}},r.a.createElement("div",{className:"progress-bar progress-bar-striped progress-bar-animated",role:"progressbar","aria-valuenow":100*a.detail.progress,"aria-valuemin":"0","aria-valuemax":"100",style:{width:"".concat(100*a.detail.progress,"%")}}))))},y=function(){var e=Object(n.useState)([]),t=Object(l.a)(e,2),a=t[0],o=t[1],c=Object(n.useState)(!1),i=Object(l.a)(c,2),s=i[0],u=i[1];Object(n.useEffect)(function(){window.storage.list().then(o);var e=setInterval(function(){var e=window.storage.getStoreInProgress();s!==e&&(window.storage.list().then(o),u(e))},1e3);return function(){clearInterval(e)}},[s]);var d=function(){var e=Object(v.a)(w.a.mark(function e(t){return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.storage.remove(t);case 2:window.storage.list().then(o);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(n.Fragment,null,r.a.createElement("ul",{className:"list-group"},s&&r.a.createElement(h,null),a.reverse().map(function(e,t){var a=e.appMetadata,n=e.offlineUri;return r.a.createElement(E,{title:a.title,key:"download_".concat(t,"_").concat(a.title),done:!0,id:a.id,removeMedia:function(){return d(n)},downloadedOn:a.downloaded})})),r.a.createElement(b,{max:2e3,current:500}))},N=function(e){var t=e.match,a=e.history,o=Object(n.useRef)(null),c=m.find(function(e){return e.id===t.params.id});return Object(n.useEffect)(function(){var e=new window.shaka.Player(o.current),a=function(e){console.error("Error code",e.code,"object",e)};return e.addEventListener("error",function(e){var t=e.detail;return a(t)}),"stream"===t.params.mode?e.load(c.manifestUri).catch(a):window.storage.list().then(function(a){var n=a.find(function(e){return e.appMetadata.id===t.params.id});e.load(n.offlineUri)}),function(){return e.destroy()}},[t,c]),r.a.createElement("div",{className:"card bg-light"},r.a.createElement("div",{className:"card-header"},c?c.title:"404",r.a.createElement("button",{type:"button",className:"close","aria-label":"Close",onClick:a.goBack},r.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),r.a.createElement("div",{className:"card-body"},c?r.a.createElement("video",{ref:o,style:{width:"100%",maxHeight:"80vh"},poster:c.poster,controls:!0,autoPlay:!0}):"Video not found."))},k=[{label:"Media",key:"media",path:"/media",exact:!0,component:f},{label:"Downloads",key:"downloads",path:"/downloads",exact:!0,component:y}],O=function(){var e=Object(n.useState)(!1),t=Object(l.a)(e,2),a=t[0],o=t[1],c=Object(n.useState)(!0),d=Object(l.a)(c,2),m=d[0],p=d[1],w=Object(n.useState)(!0),v=Object(l.a)(w,2),g=v[0],b=v[1];return Object(n.useEffect)(function(){var e=window.shaka;e.polyfill.installAll(),p(e.Player.isBrowserSupported()),b(e.offline.Storage.support()),window.storage=new e.offline.Storage,window.storage.configure({progressCallback:function(e,t){var a=new CustomEvent("custom-progress",{detail:{progress:t,content:e}});window.dispatchEvent(a)}}),o(!0)},[]),a?r.a.createElement(i.a,{onUpdate:function(){return window.scrollTo(0,0)}},r.a.createElement("div",{className:"App"},r.a.createElement(u,{routes:k}),r.a.createElement("main",{className:"container"},!(m&&g)&&r.a.createElement("div",{className:"alert ".concat(g?"alert-warning":"alert-danger"),role:"alert"},r.a.createElement("h4",{className:"alert-heading"},"Browser not supported!"),r.a.createElement("hr",null),!m&&r.a.createElement("p",{className:"mb-0"},"Your Browser is not supported as it does not support the Shaka Player"),!g&&r.a.createElement("p",{className:"mb-0"},"IndexedDB not supported! Offline viewing is disabled.")),r.a.createElement(s.a,{component:function(){return r.a.createElement("p",null,"todo welcome")},exact:!0,path:"/"}),r.a.createElement(s.a,{component:f,exact:!0,path:"/media"}),r.a.createElement(s.a,{component:y,exact:!0,path:"/downloads"}),r.a.createElement(s.a,{component:N,exact:!0,path:"/:mode(stream|offline)/:id"})))):r.a.createElement("p",null,"loading...")},j=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function x(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}c.a.render(r.a.createElement(O,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/awt-pwa",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/awt-pwa","/service-worker.js");j?(function(e,t){fetch(e).then(function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):x(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):x(t,e)})}}()}},[[20,1,2]]]);
//# sourceMappingURL=main.d48db164.chunk.js.map